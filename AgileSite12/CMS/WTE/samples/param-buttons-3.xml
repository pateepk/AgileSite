{%
    /******************************************/
    /* RetMode                                */
    /* 1 = main client page                   */
    /* 2 = to parent (client overview)        */
    /* 3 = to subaccount overview             */
    /* 4 = to employee                        */
    /* 5 = back to subaccount/company         */
    /* 6 = Quiz report main                   */
    /* 7 = Video report main                  */
    /******************************************/
    /* https://trainingnetworknow.com/System/TestMacros?sdt=12/29/2019&edt=03/27/2020&SortID=0&tf=0&Status=1&searchTerm=x */
    btn1_link = "/Streamery/Secure/Reports/Client-Reports/Quiz-Report-By-Client/Quiz-Report"; /* this link can be relative link */
    btn1_title = "Export Report";
    btn1_icon = "<svg height=\"24\" width=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"none\"><path stroke=\"#3EBDEB\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M8.5 15h7\"></path><path stroke=\"#3EBDEB\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M8.5 12h7\"></path><path stroke=\"#3EBDEB\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M8.5 9h7\"></path><path stroke=\"#3EBDEB\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M18 20h-12c-1.105 0-2-.895-2-2v-12c0-1.105.895-2 2-2h12c1.105 0 2 .895 2 2v12c0 1.105-.895 2-2 2Z\"></path></g></svg>";
    btn1_wrapCss = "drop-menu_item";
    btn1_css = "btn btn-icon";
    btn1_return = "6";
    btn1_addparam = "1";
    btn1_params = "";
    btn2_link = "";
    btn2_title = "";
    btn2_icon = "fas fa-video";
    btn2_wrapCss = "drop-menu_item";
    btn2_css = "btn-admin";
    btn2_return = "4";
    btn2_addparam = "1";
    btn2_params = "";
    btn3_link = "";
    btn3_title = "";
    btn3_icon = "fas fa-user-plus";
    btn3_wrapCss = "drop-menu_item";
    btn3_css = "btn-admin";
    btn3_return = "4";
    btn3_addparam = "1";
    btn3_params = "";

    userCompany = Convert.ToString(CurrentUser.UserCompany, "");
    userGuid = Convert.ToString(QueryString.GetValue("eid"),"");
    sortId = Convert.ToString(QueryString.GetValue("sid"),"");
    status = Convert.ToString(QueryString.GetValue("status"),"");
    searchTerm = Convert.ToString(QueryString.GetValue("search"),"");
    timeFrame = Convert.ToString(QueryString.GetValue("tf"),"");
    startDate = Convert.ToString(QueryString.GetValue("sdt"),"");
    endDate = Convert.ToString(QueryString.GetValue("edt"),"");
    showall = Convert.ToString(QueryString.GetValue("showall"),"");

    redirectUrl = "/Secure/Administration/Clients/";
    r = Convert.ToString(QueryString.GetValue("r"),""); /* return mode  */
    dpguid = Convert.ToString(ParentItemGUID, ""); /* parentItemGUID from datasource */
    dpcid  = Convert.ToString(ParentItemID,""); /* parentItemID from datasource */
    dcguid = Convert.ToString(ItemGUID, ""); /* ItemGUID from datasource */
    dcid = Convert.ToString(ItemID, ""); /* ItemID from dataSource */
    back = Convert.ToString(QueryString.GetValue("back"), "");
    parent = Convert.ToString(QueryString.GetValue("parent"), "");
    client = Convert.ToString(QueryString.GetValue("client"), "");
    subaccount = Convert.ToString(QueryString.GetValue("subaccount"), "");
    itemid = Convert.ToString(QueryString.GetValue("ItemID"), "");
    cid = Convert.ToString(QueryString.GetValue("cid"), "");
    pcid = Convert.ToString(QueryString.GetValue("pcid"), "");
    vid = Convert.ToString(QueryString.GetValue("vid"), ""); /* video/product id */
    vguid = Convert.ToString(QueryString.GetValue("vguid"), ""); /* video/product guid */
    qid = Convert.ToString(QueryString.GetValue("qvid"), ""); /* quiz id */
    qguid = Convert.ToString(QueryString.GetValue("qguid"), ""); /* quiz guid */


    newparams = "";
    useCid = "";
    buttons = "";

    if (cid != "")
    {
        useCid = cid;
    }
    else
    {
        if (userCompany != "")
        {
            useCid = userCompany;
        }
    }

    if (parent != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "parent=" + parent;
    }

    if (client != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "client=" + client;
    }

    if (subaccount != "")
    {
        if (newparams != "")
        {
        newparams = newparams + "&";
        }
        newparams = newparams + "subaccount=" + subaccount;
    }

    if (useCid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "cid=" + useCid;
    }

    if (useCid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "CompanyID=" + useCid;
    }

    if (pcid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "pcid=" + client;
    }
    
    if (r != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "r=" + r;
    }    

    if (userGuid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "eid=" + userGuid;
    }

    if (vid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "vid=" + vid;
    }

    if (vguid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "vguid=" + vguid;
    }

    if (qid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "qid=" + qid;
    }

    if (qguid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "qguid=" + guid;
    }

    if (itemid != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "itemid=" + itemid;
    }

    if (sortId != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "sid=" + sortId;
    }

    if (status != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "status=" + status;
    }

    if (searchTerm != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "search=" + searchTerm;
    }

    if (timeFrame != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "tf=" + timeFrame;
    }

    if (startDate != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "sdt=" + startDate;
    }

    if (endDate != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "edt=" + endDate;
    }

    if (showall != "")
    {
        if (newparams != "")
        {
            newparams = newparams + "&";
        }
        newparams = newparams + "showall=" + showall;
    }

    if (btn1_addparam == "1")
    {
        btn1_params = newparams;
    }

    if (btn1_return != "")
    {
        if (btn1_params != "")
        {
            btn1_params = btn1_params + "&";
        }
        btn1_params = btn1_params + "r=" + btn1_return;
    }

    if (btn1_link != "")
    {
        if (btn1_params != "")
        {
            btn1_link = btn1_link + "?" + btn1_params;
        }
    }

    if (btn2_addparam == "1")
    {
        btn2_params = newparams;
    }

    if (btn2_return != "")
    {
        if (btn2_params != "")
        {
            btn2_params = btn2_params + "&";
        }
        btn2_params = btn2_params + "r=" + btn2_return;
    }

    if (btn2_link != "")
    {
        if (btn2_params != "")
        {
            btn2_link = btn2_link + "?" + btn1_params;
        }
    }

    if (btn3_addparam == "1")
    {
        btn3_params = newparams;
    }

    if (btn3_return != "")
    {
        if (btn3_params != "")
        {
            btn3_params = btn3_params + "&";
        }
        btn3_params = btn3_params + "r=" + btn3_return;
    }

    if (btn3_link != "")
    {
        if (btn3_params != "")
        {
            btn3_link = btn3_link + "?" + btn3_params;
        }
    }

    if (btn1_link != "")
    {
        buttons = buttons + "<div class=\"" + btn1_wrapCss + "\"><a class=\"" + btn1_css + "\" href=\"" + btn1_link + "\">" + btn1_icon +"<span>" + btn1_title + "</span></a></div>";
    }

    if (btn2_link != "")
    {
        buttons = buttons + "<div class=\"" + btn2_wrapCss + "\"><a class=\"" + btn2_css + "\" href=\"" + btn2_link + "\">" + btn1_icon +"<span>" + btn2_title + "</span></a></div>";
    }

    if (btn3_link != "")
    {
        buttons = buttons + "<div class=\"" + btn3_wrapCss + "\"><a class=\"" + btn3_css + "\" href=\"" + btn3_link + "\">" + btn1_icon +"<span>" + btn3_title + "</span></a></div>";
    }

    Convert.ToString(buttons);

#%}