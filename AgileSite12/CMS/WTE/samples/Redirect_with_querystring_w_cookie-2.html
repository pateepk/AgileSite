<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <script type="text/javascript">

        //document.addEventListener('DOMContentLoaded', function () {
        //    SetBcexCookie();
        //});

        // set the cookie!
        function SetBcexCookie() {
            var devModeURL = "https://clinicoracle.myonlineordering.com?";
            var onlineOrderingURL = "https://clinicoracle.myonlineordering.com?"
            var isDevMode = false

            if (action === "setCookie") {

                var mode = getParamWithDefault('mode', 'dev');
                var site = getParamWithDefault('site', null);

                if (mode != null) {
                    createCookie('mode', mode, null, null, 15);
                }

                if (site != null) {
                    createCookie('site', site, null, null, 15);
                }
            }
        }

        // name value from query string
        function getParameterByName(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)'),
                results = regex.exec(location.search);
            return results == null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Get parameter
        function getParamWithDefault(name, defaultval) {
            var ret = getParameterByName(name);
            if (typeof (ret) == 'undefined' || ret == '' || ret == null) {
                ret = defaultval;
            }
            return ret;
        }

        // remove all param from url
        function resetStats() {
            var clearURL = window.location.href.substr(0, window.location.href.indexOf('?'));
            if (!clearURL) {
                clearURL = window.location.href;
            }
            window.location.href = clearURL;
        }

        // redirect
        function doRedirect(location) {
            var mode = getParamWithDefault('mode', 'dev');
            var site = getParamWithDefault('site', null);
            var redirectUrl = "https://clinicoracle.myonlineordering.com/";

            if (typeof (site) == 'undefined' || site != null && site != '') {
                redirectUrl = redirectUrl + location;
                redirectWithQueryStringVars(
                    redirectUrl,
                    {
                        'mode': mode,
                        'site': site
                    }
                );

            }
            // otherwise, something is wrong...
        }

        function redirectWithQueryStringVars(url, queryStringVars) {

            var existingQueryVars = location.search ? location.search.substring(1).split('&') : [];
            var currentUrl = location.search ? location.href.replace(location.search, '') : location.href;
            var newQueryVars = {};
            var newUrl = currentUrl + '?';

            if (url != null) {
                newUrl = url + '?';
            }
            else {
                newUrl = currentUrl + '?';
            }

            if (existingQueryVars.length > 0) {
                for (var i = 0; i < existingQueryVars.length; i++) {
                    var pair = existingQueryVars[i].split('=');
                    newQueryVars[pair[0]] = pair[1];
                }
            }

            if (queryStringVars) {
                for (var queryStringVar in queryStringVars) {
                    newQueryVars[queryStringVar] = queryStringVars[queryStringVar];
                }
            }

            if (newQueryVars) {
                for (var newQueryVar in newQueryVars) {
                    if (typeof (newQueryVars[newQueryVar]) == 'undefined' || newQueryVars[newQueryVar] == '') {
                        // do nothing
                    }
                    else {
                        newUrl += newQueryVar + '=' + newQueryVars[newQueryVar] + '&';
                    }
                }
                newUrl = newUrl.substring(0, newUrl.length - 1);
                window.location.href = newUrl;
            } else {
                window.location.href = location.href;
            }
        }

        function createCookie(name, value, days, hours, min) {
            var daysinms = 0;
            if (days != null) {
                daysinms = (days * 24 * 60 * 60 * 1000);
            }
            var hoursinms = 0;
            if (hours != null) {
                hoursinms = (hours * 60 * 60 * 1000);
            }
            var minutesinms = 0
            if (mins != null) {
                minutesinms = (mins * 60 * 1000);
            }

            var addedTime = daysinms + hoursinms + minutesinms;

            var expires = '';
            if (addedTime > 0) {
                var expiredDate = new Date();
                expiredDate = date.getTime();
                expires = '; expires=' + expiredDate.toGMTString();
            }
            else {
                // no expiration?
                expires = '';
            }
            document.cookie = name + '=' + value + expires + '; path=/';
        }

        function readCookie(name) {
            var nameEQ = name + '=';
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
    </script>

    <!-- buttons -->
    <input class="btn btn-default" id="coaStringToolsBtn" onclick="doRedirect('COA-String');" type="button" value="COA String" />
    <input class="btn btn-default" id="projStringToolsBtn" onclick="doRedirect('Project-String');" type="button" value="Project String" />
    <!-- end buttons -->
</body>
</html>